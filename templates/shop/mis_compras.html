<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power.Lab</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/main/index.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages/mis_compras.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
    <header class="Encabezado">
        <div class="Titulo-container">
            <a href="{{ url_for('index') }}" class="Boton-Inicio">
                <h1 class="Titulo-header">Power.Lab</h1>
                <i class="fas fa-dumbbell" style="color: #d2cfcf; font-size: 48px;"></i>
            </a>
        </div>

        <nav class="Menu-links">
            <a href="{{ url_for('perfil') }}">PERFIL</a>
            <a href="{{ url_for('productos') }}">PRODUCTOS</a>
            <a href="{{ url_for('productos') }}">DESCUENTOS</a>
            <a href="{{ url_for('mis_compras') }}">MIS COMPRAS</a>
        </nav>

        {% if session.get("user_id") %}
            <span class="Inicio-sesion">
                {% if session.get("user_tipo") == "admin" %}
                    ADMIN: Hola {{ session.get("user_nombre") }}
                {% else %}
                    Hola {{ session.get("user_nombre") }}
                {% endif %}
                <a href="{{ url_for('logout') }}" style="color: inherit; text-decoration: underline;">Logout</a>
            </span>
        {% else %}
            <a href="{{ url_for('login_get') }}" class="Inicio-sesion">
                Iniciar sesión/<br>Registrarse
            </a>
        {% endif %}

        <a href="{{ url_for('carrito') }}" class="Boton-carrito">
            <i class="fa-solid fa-cart-shopping"></i>
            <span class="Contador">{{ count if count else 0 }}</span>
        </a>
    </header>

    <div class="Slate">

        {% if pedidos and (pedidos|length > 0) %}

            {% for p in pedidos %}
                <div class="Compra-box">

                    <div style="padding: 10px 0; color: #d2cfcf;">
                        <strong>Pedido #{{ p["id"] }}</strong>
                        {% if p["fecha"] %} - {{ p["fecha"] }}{% endif %}
                    </div>

                    <div class="Compra-info">

                        {% if p["items"] and (p["items"]|length > 0) %}
                            {% for it in p["items"] %}
                                <div class="Compra-item">
                                    <img src="{{ it['imagen'] }}" alt="{{ it['nombre'] }}">

                                    <div class="Compra-detalles">
                                        <h3>{{ it["nombre"] }}</h3>

                                        {% if it["sabor"] %}
                                            <p><strong>Sabor:</strong> {{ it["sabor"] }}</p>
                                        {% endif %}

                                        <p>{{ it["descripcion"] }}</p><br>

                                        <p><strong>Precio:</strong> ${{ it["precio"] }}</p>
                                        <p><strong>Cantidad:</strong> {{ it["cantidad"] }}</p>
                                    </div>
                                </div>
                            {% endfor %}

                            <div class="Compra-datos">
                                <p><strong>Total:</strong> ${{ p["total"] }}</p>
                            </div>
                        {% else %}
                            <p style="color:#d2cfcf;">Este pedido no tiene items.</p>
                        {% endif %}

                    </div>

                    <div class="Estado-compra">
                        <p><strong>Estado del pedido:</strong> {{ p["estado"] }}</p>
                    </div>

                </div>
            {% endfor %}

        {% else %}
            <p style="color:white; padding: 20px;">Todavía no tenés pedidos.</p>
        {% endif %}

    </div>

    <footer class="Pie-pagina">
        <div class="Slogan">
            <p>
                <span class="Resaltado-slogan">Power.Lab</span><br>
                Suplementación<br><br>
                Somos personas normales como tú,<br>
                que nos gusta el deporte y el gimnasio<br>
                y queremos ayudarte a mejorar.
            </p>
        </div>
        <div class="ANMAT">
            <p>
                Productos regulados y verificados por la <span class="Resaltado-ANMAT">ANMAT</span>,<br>
                cumpliendo requisitos de seguridad, calidad y registro.
            </p>
        </div>
        <div class="Metodos-pago">
            <i class="fab fa-cc-visa"></i>
            <i class="fab fa-cc-mastercard"></i>
            <img src="{{ url_for('static', filename='img/logos/mercadopago.png') }}" alt="Mercado Pago">
        </div>
    </footer>

</body>
</html>